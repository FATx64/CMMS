{% extends "dashboard/base.html" %}

{% block script %}
<script>
let openedModal = null

document.addEventListener("DOMContentLoaded", () => {
    const buttons = document.querySelectorAll("button[data-modal]")
    buttons.forEach((btn) => {
        btn.onclick = openModal
    })
})

function openModal() {
    if (openedModal)  // How?
        closeModal()
    openedModal = document.querySelector(this.getAttribute("data-modal"))

    const buttons = openedModal.querySelectorAll("button[data-dismiss]")
    buttons.forEach((btn) => {
        btn.onclick = closeModal
    })

    document.documentElement.style.overflow = "hidden"
    openedModal.showModal()
}

function closeModal() {
    if (!openedModal)  // Just in-case
        openedModal = document.querySelector(this.getAttribute("data-dismiss"))
    document.documentElement.style.overflow = ""
    openedModal.close()
    const form = openedModal.children[0]
    if (form)
        form.reset()
    openedModal = null
}

window.onclick = function(event) {
    if (openedModal && event.target === openedModal)
        closeModal()
}
</script>
{% endblock %}
